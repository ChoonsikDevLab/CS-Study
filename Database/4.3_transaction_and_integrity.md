## 4.3 트랜잭션과 무결성

### 4.3.1 트랜잭션
- **트랜잭션(transaction)**: 데이터베이스에서 하나의 논리적 기능을 수행하기 위한 작업의 단위. 여러 개의 쿼리들을 하나로 묶음.

- **초당 트랜잭션(TPS: Transaction Per Second): 데이터베이스의 작업 성능을 나타내는 지표.

- **ACID 특성**:

    - **원자성(Atomicity)**: 트랜잭션과 관련된 모든 작업이 완전히 수행되거나 전혀 수행되지 않음(All or Notiong)을 보장함.

    - **일관성(Consistency)**: 데이터가 허용된 방식으로만 변경되어야 함.

    - **격리성(Isolation)**: 트랜잭션 수행 중 다른 트랜잭션의 간섭을 받지 않음.

        - 격리 수준: SERIALIZABLE, REPEATABLE READ, READ COMMITTED, READ UNCOMMITTED

        - 격리 수준에 따라 발생할 수 있는 문제: 팬텀 리드, 반복 불가능한 조회, 더티 리드

    - **지속성(Durability)**: 성공적으로 완료된 트랜잭션은 영구적으로 반영되어야 함.

        - 데이터베이스는 체크섬, 저널링, 롤백 기능을 제공함.

- **트랜잭션의 데이터 무결성 보장 방법**:

    - **커밋(Commit)**: 여러 쿼리가 성공적으로 처리되었다고 확정하는 명령어.

    - **롤백(Rollback)**: 에러나 이슈로 인해 트랜잭션을 이전 상태로 되돌릴 때 사용하는 명령어.

![image](https://github.com/user-attachments/assets/df8895bc-e973-4b4b-bf73-52364e772d99)
▲ 커밋과 롤백 (출처: 이것이 취업을 위한 컴퓨터 과학이다 with CS 기술 면접 p.525)

- **트랜잭션 전파**: 트랜잭션을 수행할 때 커넥션 객체를 넘겨서 수행하지 않고, 여러 트랜잭션 관련 메서드의 호출을 하나의 트랜잭션에 묶임.

### 4.3.2 무결성
- **무결성**: 데이터의 정확성, 일관성, 유효성을 유지하는 것.

    - **개체 무결성**: 기본키로 선택된 필드는 빈 값을 허용하지 않음.

    - **참조 무결성**: 서로 참조 관계에 있는 두 테이블의 데이터는 항상 일관된 값을 유지해야 함.

    - **고유 무결성**: 특정 속성에 대해 고유한 값을 가지도록 조건이 주어짐.

    - **NULL 무결성**: 특정 속성 값에 NULL이 올 수 없다는 조건이 주어짐.


## 4.3 예상 질문

<details>
<summary>

### 1. `트랜잭션(transaction)`이란 무엇인지 설명해주세요.

</summary>

```
트랜잭션은 데이터베이스에서 하나의 논리적 기능을 수행하기 위한 작업의 단위로, 여러 개의 쿼리들을 하나로 묶습니다.
트랜잭션의 주요 목적은 데이터의 무결성과 일관성을 유지하는 것이며, 성공적으로 완료된 트랜잭션은 데이터베이스에 영구적으로 반영되어야 합니다.

```

</details>

<details>
<summary>

### 2. `트랜잭션의 특징`은 무엇인지 설명해주세요.

</summary>

```
트랜잭션의 주요 특징으로는 원자성, 일관성, 독립성, 지속성이 있습니다.
- 원자성(Atomicity): 트랜잭션의 모든 작업이 완전히 수행되거나 전혀 수행되지 않습니다.
- 일관성(Consistency): 트랜잭션이 데이터를 항상 일관된 상태로 유지합니다.
- 격리성(Isolation): 트랜잭션이 다른 트랜잭션의 영향 없이 독립적으로 수행됩니다.
    - 격리 수준에는 SERIALIZABLE, REPEATABLE READ, READ COMMITTED, READ UNCOMMITTED이 있으며, 격리 수준이 낮을수록 팬텀 리드, 반복 불가능한 조회, 더티 리드와 같은 문제가 발생할 수 있습니다.
- 지속성(Durability): 트랜잭션이 성공적으로 완료되면, 그 결과는 데이터베이스에 영구적으로 반영됩니다.
```

</details>

<details>
<summary>

### 3. `트랜잭션의 상태`에 대해서 설명해주세요.

</summary>

```
트랜잭션의 상태에는 활동(Active), 부분 완료(Partially Committed), 완료(Committed), 실패(Failed), 철회(Aborted)의 다섯 가지 상태가 있습니다.
- 활동 상태는 트랜잭션이 실행 중임을 나타내며,
- 부분 완료 상태는 모든 명령이 실행됐지만 아직 데이터베이스에 반영되지 않은 상태입니다.
- 완료 상태는 모든 변경사항이 데이터베이스에 반영되어 성공적으로 끝난 상태,
- 실패 상태는 오류로 인해 트랜잭션이 중단된 상태,
- 그리고 철회 상태는 트랜잭션이 롤백되어 이전 상태로 돌아간 상태를 의미합니다.
```

</details>

<details>
<summary>

### 4. `트랜잭션의 격리수준`에 대해 설명해주세요.

</summary>

```
트랜잭션의 격리수준은 트랜잭션들이 서로 어느 정도 보이는지를 정의합니다.
격리수준에는 Read Uncommitted, Read Committed, Repeatable Read, Serializable 네 가지가 있습니다.
- Read Uncommitted는 다른 트랜잭션이 아직 커밋하지 않은 데이터를 읽을 수 있습니다.
- Read Committed는 커밋된 데이터만 읽을 수 있습니다.
- Repeatable Read는 트랜잭션 동안 조회한 데이터가 외부 변경으로부터 보호되는 것을 보장합니다.
- Serializable은 트랜잭션이 완벽하게 순차적으로 실행되는 것처럼 보장하여 가장 엄격한 격리수준을 제공합니다.
```

</details>

<details>
<summary>

### 5. 트랜잭션의 연산 중, `Commit`과 `Rollback`에 대해 설명해주세요.

</summary>

```
두 연산은 트랜잭션이 데이터의 일관성과 정확성을 유지하는 데 중요한 역할을 합니다.
- 커밋(Commit): 트랜잭션이 성공적으로 완료되었을 때, 그 결과를 데이터베이스에 영구적으로 저장하는 명령어입니다.
- 롤백(Rollback): 트랜잭션 처리 중 발생한 에러나 문제로 인해 트랜잭션을 이전 상태로 되돌리는 명령어입니다.
```

</details>

<details>
<summary>

### 6. `무결성`이 무엇인지, `무결성 제약 조건`은 무엇인지 설명해주세요.

</summary>

```
무결성은 데이터의 정확성, 일관성, 유효성을 유지하는 것을 말하며, 데이터베이스에서는 다음과 같은 무결성 제약 조건을 설정하여 이를 보장합니다.
- 개체 무결성: 기본키로 선택된 필드는 빈 값을 허용하지 않습니다.
- 참조 무결성: 서로 참조 관계에 있는 두 테이블은 항상 일관된 데이터를 유지해야 합니다.
- 고유 무결성: 특정 속성에 대해 중복 없이 고유한 값을 유지해야 합니다.
- NULL 무결성: 특정 속성 값에 NULL이 허용되지 않는 경우를 정의합니다.
```

</details>

&nbsp;

※ 자세한 내용은 [블로그](https://mandusitstudy.tistory.com/315)를 참고해주세요.