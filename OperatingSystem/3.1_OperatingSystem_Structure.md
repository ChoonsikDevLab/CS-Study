# 3.1. 운영체제
## 운영체제 역할
1. CPU 관리: CPU 스케줄링
	- 우선순위, 스케줄링 큐, 선점형과 비선점형
	- CPU 스케줄링 알고리즘
2. 메모리 관리: 가상 메모리
	- 물리주소와 논리 주소
	- 메모리 할당
	- 페이징과 페이지 교체 알고리즘
3. 디스크 파일 관리: 파일 시스템
	- 파일과 디렉터리
	- 파일 시스템
4. 프로세스 및 스레드 관리
5. I/O 디바이스 관리
	- I/O 디바이스(마우스, 키보드)간의 전송 관리

## 운영체제 구조
하드웨어 | (드라이버 | 커널 | 시스템 콜 | GUI) | 유저 프로그램

프로그램이 실행되기 위해서 반드시 메모리에 적재되어야 하며, 운영체제와 일반 프로그램이 적재되는 공간은 다르다.

**커널 영역(kernel space)** : 운영체제가 적재되는 영역
**사용자 영역(user space)** : 사용자 응용 프로그램이 적재되는 공간

응용 프로그램은 운영체제와 달리 CPU, 메모리 같은 자원에 직접 접근/조작할 수 없다.  
이러한 행위는 운영체제가 대신 자신의 코드를 실행해줘야 하는데, 시스템 콜을 호출하여 접근할 수 있다.

### 시스템 콜(system call)
운영체제의 커널이 제공하는 서비스에 대해 사용자 프로그램이 커널에 접근하기 위한 인터페이스

**주요 특징**
- 사용자 모드와 커널 모드 간의 전환
- 하드웨어 접근
- API를 통한 간접 사용

**주요 시스템 콜 종류**
- 프로세스 제어 : `fork()`, `execve()`, `exit()`, `waitpid()`
- 파일 조작 : `open()`, `close()`, `read()`, `write()`, `stat()`
- 디렉토리 관리 : `chdir()`, `mkdir()`, `rmdir()`
- 파일 시스템 관리 : `mount()`, `umount()`
- 장치 관리 : `ioctl()` 
	등 ...

![image](https://github.com/user-attachments/assets/c432ab0f-0bc9-4793-b238-73e2b1ba4d46)

출처 : https://ghleokim.github.io/운영체제-유저모드와-커널모드/

프로세스는 시스템 콜을 통해 다른 프로세스를 생성하고 생성된 프로세스는 다시 다른 프로세스를 생성할 수 있다.  
이 때 생성하는 프로세스를 **부모 프로세스(parent process)**, 생성된 프로세스를 **자식 프로세스(child process)** 라고 한다.

#### 시스템 콜 실행 과정
소프트웨어 인터럽트가 발생하고나서 CPU 작업을 전환한 후 실행된다.  

**소프트웨어 인터럽트** : 프로그램 내부에서 발생하는 인터럽트로 주로 소프트웨어 명령어 수행에 의해 발생  

CPU가 현재 실행중인 작업을 멈추고 특정 작업(운영체제)을 처리하도록 요청  
소프트웨어 인터럽트는 **동기적**으로 발생, 예외 상황 처리나 **시스템 콜** 같은 작업에서 주로 사용

1. 사용자 영역을 실행하는 과정에서 시스템 콜 호출
2. CPU는 현재 수행 중인 작업을 백업
3. 커널 영역 내 인터럽트를 처리하기 위한 코드(시스템 콜 코드) 실행
4. 처리 완료 후 사용자 영역 코드 실행 재개

![image](https://github.com/user-attachments/assets/64b376d2-6c1b-4e76-8290-303b770aecbb)

출처 : http://www.it.uu.se/education/course/homepage/os/vt18/module-1/exception-and-interrupt-handling/

CPU는 명령어를 실행할 때 사용자 영역을 실행할 때의 모드와 커널 영역을 실행할 때의 모드를 구분하여 실행한다.

- **사용자 모드(user mode)**
	- 운영체제 서비스를 제공 받을 수 없는 모드
	- 커널 영역의 코드를 실행할 수 없음
	- 자원에 직접 접근하는 명령어 실행 불가
- **커널 모드(kernel mode)**
	- 운영체제 서비스를 제공 받을 수 있는 모드
	- 커널 영역의 코드 실행 가능
	- 모든 명령어 실행 가능

위와 같이 두 개의 모드로 구분하여 실행하는 것을 이중 모드(dual mode) 라고 한다.

**시스템 콜의 중요성**
- 간단한 `hello world` 프로그램도 600회 이상의 시스템 콜을 호출한다.
- 명령어 (예 : `ls`)도 프로그램이므로 실행 시 많은 시스템 콜을 사용한다.
- 프로그램은 시스템 콜을 통해 사용자 모드와 커널 모드를 전환하며 운영체제의 기능을 활용한다.

# 컴퓨터 구성 요소
(컴퓨터 구조 내용이기에 추후 컴퓨터 구조 파트 참고)

- CPU(Contral Processing Unit) : 산술논리연산장치, 제어장치, 레지스터로 구성된 컴퓨터 장치
- 제저장치(CU, Control Unit) : 프로세스 조작을 지시하는 장치 (입출력장치 간 통신 제어, 명령어 읽고 해성, 데이터 처리 순위 결정)
- 레지스터 : CPU와 직접 연결된 임시 저장장치(주기억장치)
- 산술논리연산장치(ALU, Arithmetric Login Unit) : 산술 연산, 배타적 논리합, 논리곱 같은 논리 연산을 하는 장치
- 인터럽트 : 어떤 신호가 들어왔을 때 CPU를 잠시 정지시키는 행위
	- 하드웨어 인터럽트 : IO 디바이스에서 발생하는 인터럽트(키보드, 마우스 연결 등)
	- 소프트웨어 인터럽트 : 트랩(trap)아라고도 함, 프로세스 오류 등으로 프로세스가 시스템 콜을 호출 할 경우
- DMA 컨트롤러 : I/O 디바이스가 메모리에 직접 접근할 수 있도록 하는 하드웨어 장치
  CPU에 몰리는 인터럽트 부하를 막는 보조 장치
